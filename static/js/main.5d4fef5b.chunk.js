(this["webpackJsonpnab-weather-forecast"]=this["webpackJsonpnab-weather-forecast"]||[]).push([[0],{116:function(e,t,n){},117:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(17),i=n.n(r),o=(n(77),n(23)),s=n(18),u=n(30),l=n.n(u),d=n(39),j=n(61),b=n(62),h=n(40),m=n.n(h),p=new(function(){function e(){Object(j.a)(this,e)}return Object(b.a)(e,[{key:"searchLocations",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("/api/location/search/",{params:{query:t}});case 2:return n=e.sent,a=n.data,c=void 0===a?[]:a,e.abrupt("return",c.map((function(e){var t=e.woeid,n=e.location_type;return{id:t,name:e.title,type:n}})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLocationWeather",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("/api/location/".concat(t,"/"));case 2:return n=e.sent,a=n.data,c=a.consolidated_weather,r=void 0===c?[]:c,e.abrupt("return",r.map((function(e){return{id:e.id,minTemp:e.min_temp,maxTemp:e.max_temp,date:e.applicable_date}})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}());var f="en-US";function v(e){var t=new Date(e);return function(e){return e.toLocaleDateString(f)===(new Date).toLocaleDateString(f)}(t)?"Today":t.toLocaleDateString(f,{weekday:"long"})}function O(e){return"".concat(Math.round(e),"\xb0C")}var x=n(5);function g(e){var t,n=e.data,a=v(n.date),c=(t=n.date,new Date(t).toLocaleDateString(f,{year:"numeric",month:"short",day:"numeric"})),r=O(n.minTemp),i=O(n.maxTemp);return Object(x.jsxs)("div",{className:"card",children:[Object(x.jsxs)("div",{className:"card-header",children:[Object(x.jsx)("h5",{className:"card-title",children:a}),Object(x.jsx)("p",{className:"card-subtitle text-muted",children:c})]}),Object(x.jsx)("div",{className:"card-body",children:Object(x.jsxs)("div",{className:"card-text",children:[Object(x.jsxs)("div",{children:["Min: ",r]}),Object(x.jsxs)("div",{children:["Max: ",i]})]})})]})}n(98);function y(e){var t=e.location,n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n="number"===typeof e,c=Object(a.useCallback)((function(){return n?p.getLocationWeather(e):[]}),[e,n]),r=Object(s.useQuery)(["locationWeather",e],c,{enabled:n}),i=r.isLoading,o=r.data,u=void 0===o?[]:o,l=r.error;return{isLoading:i,data:u.slice(0,t),error:l}}(null===t||void 0===t?void 0:t.id),c=n.isLoading,r=n.data;return Object(x.jsx)("div",{className:"LocationWeather py-4",children:Object(x.jsxs)("div",{className:"container",children:[Object(x.jsxs)("div",{className:"text-center mb-3",children:[Object(x.jsx)("h3",{className:"text-primary",children:null===t||void 0===t?void 0:t.name}),c&&Object(x.jsx)("h4",{children:"..."})]}),Object(x.jsx)("div",{className:"row",role:"listbox",children:r.map((function(e){return Object(x.jsx)("div",{className:"col py-3",role:"listitem",children:Object(x.jsx)(g,{data:e})},e.id)}))})]})})}function L(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],c=t[1],r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=Object(a.useState)(e),c=Object(o.a)(n,2),r=c[0],i=c[1];return Object(a.useEffect)((function(){var n=setTimeout((function(){i(e)}),t);return function(){clearTimeout(n)}}),[e,t]),r}(n),i=Object(a.useCallback)((function(e){return c(e)}),[]),u=Object(a.useCallback)((function(){return p.searchLocations(r)}),[r]),l=Object(s.useQuery)(["locations",r],u,{enabled:!!r}),d=l.isLoading,j=l.data;return{isLoading:d,locations:void 0===j?[]:j,search:i,error:l.error}}var w=n(41),C=n(64),N=n(2),S=n(63),k=n.p+"static/media/search.65a7fd14.svg",T=(n(99),function(){return"No results"}),D=function(e){var t=e.children,n=Object(C.a)(e,["children"]);return Object(x.jsxs)(N.p.Control,Object(w.a)(Object(w.a)({},n),{},{children:[Object(x.jsx)("div",{className:"Autocomplete__leadingIcon",children:Object(x.jsx)("img",{src:k,alt:"Search"})}),t]}))};function _(e){var t=e.labelKey,n=e.valueKey,a=e.items,c=e.placeholder,r=e.loading,i=e.onChange,o=e.onSelect;return Object(x.jsx)(S.a,{autoFocus:!0,isClearable:!0,className:"Autocomplete",placeholder:c,getOptionLabel:function(e){return e[t]},getOptionValue:function(e){return e[n]},options:a,isLoading:r,components:{Control:D},noOptionsMessage:T,onInputChange:function(e){a.find((function(n){return n[t].toString().toLowerCase().includes(e.toLowerCase())}))||i(e)},onChange:function(e,t){"clear"!==t.action?"select-option"===t.action&&e&&o(e):i("")}})}n(116);function F(e){var t=e.onSelect,n=L(),a=n.isLoading,c=n.locations,r=n.search;return Object(x.jsx)("div",{className:"SearchBar app-bar navbar bg-dark",children:Object(x.jsx)("div",{className:"container py-3",children:Object(x.jsx)(_,{labelKey:"name",valueKey:"id",placeholder:"Search city...",items:c,loading:a,onChange:r,onSelect:t})})})}n(117);var M=new s.QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:3e5}}});var W=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(x.jsx)("div",{className:"App",children:Object(x.jsxs)(s.QueryClientProvider,{client:M,children:[Object(x.jsx)(F,{onSelect:c}),Object(x.jsx)(y,{location:n})]})})},I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,121)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};i.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(W,{})}),document.getElementById("root")),I()},77:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){}},[[118,1,2]]]);
//# sourceMappingURL=main.5d4fef5b.chunk.js.map